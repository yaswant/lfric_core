<?xml version="1.0" encoding="UTF-8"?>
<simulation> 

  <!-- In this version we have ONE context  -->
  
  
  <context id = "gungho_atm">
  
   <calendar type = "Gregorian" start_date = "2016-01-01 15:00:00" time_origin = "2016-01-01 15:00:00" />

   <axis_definition>
    <axis id="vert_axis_half_levels" name="half_levels"/>
    <axis id="vert_axis_full_levels" name="full_levels"/>   
   </axis_definition>

   <domain_definition>
      <domain id="node" name="Mesh2d_node" nvertex="1"/>
      <domain id="face_half_levels" name="Mesh2d_half_levels" nvertex="4"/>
      <domain id="face_full_levels" name="Mesh2d_full_levels" nvertex="4"/>
      <domain id="edge_half_levels" name="Mesh2d_edge_half_levels" nvertex="2"/>
      <domain id="restart_W0" name="restart_W0" nvertex="1"/>
      <domain id="restart_W1" name="restart_W1" nvertex="1"/>
      <domain id="restart_W2" name="restart_W2" nvertex="1"/>
      <domain id="restart_W3" name="restart_W3" nvertex="1"/>
      <domain id="restart_Wtheta" name="restart_Wtheta" nvertex="1"/>
      <domain id="fd_restart_W3" name="fd_restart_W3" nvertex="1"/>
      <domain id="fd_restart_Wtheta" name="fd_restart_Wtheta" nvertex="1"/>
      <domain id="restart_W3_2D" name="restart_W3_2D" nvertex="1"/>
   </domain_definition>

   <grid_definition>
    <grid id="node_grid">
      <domain domain_ref="node"/>
      <axis axis_ref="vert_axis_full_levels"/>
    </grid>
    <grid id="half_level_face_grid">
      <domain domain_ref="face_half_levels"/>
      <axis axis_ref="vert_axis_half_levels"/>
    </grid>
    <grid id="full_level_face_grid">
      <domain domain_ref="face_full_levels"/>
      <axis axis_ref="vert_axis_full_levels"/>
    </grid>
    <grid id="half_level_edge_grid">
      <domain domain_ref="edge_half_levels"/>
      <axis axis_ref="vert_axis_half_levels"/>
    </grid>
   </grid_definition>

   <field_definition prec="8" >

     <!-- Checkpoint group -->
     <field_group id="checkpoint_fields" freq_op="1ts" operation="once"  enabled=".FALSE." >
       <field id="checkpoint_theta" name="theta" long_name="air_potential_temperature" standard_name="air_potential_temperature" unit="K" domain_ref="restart_Wtheta" />
       <field id="checkpoint_rho" name="rho" long_name="air_density" standard_name="air_density" unit="kg m-3" domain_ref="restart_W3" />
       <field id="checkpoint_exner" name="exner" long_name="exner_pressure" unit="1" domain_ref="restart_W3" />
       <field id="checkpoint_u" name="u" long_name="U" unit="m s-1" domain_ref="restart_W2" />
       <field id="checkpoint_xi" name="xi" long_name="Xi" unit="s-1" domain_ref="restart_W1" />
       <field id="checkpoint_m_v" name="m_v" long_name="m_v" unit="kg/kg" domain_ref="restart_Wtheta" />
       <field id="checkpoint_m_cl" name="m_cl" long_name="m_cl" unit="kg/kg" domain_ref="restart_Wtheta" />
       <field id="checkpoint_m_r" name="m_r" long_name="m_r" unit="kg/kg" domain_ref="restart_Wtheta" />
       <field id="checkpoint_m_ci" name="m_ci" long_name="m_ci" unit="kg/kg" domain_ref="restart_Wtheta" />
       <field id="checkpoint_m_s" name="m_s" long_name="m_s"  unit="kg/kg" domain_ref="restart_Wtheta" />
       <field id="checkpoint_m_g" name="m_g" long_name="m_g"  unit="kg/kg" domain_ref="restart_Wtheta" />
       <field id="checkpoint_area_fraction" name="area_fraction" long_name="area_fraction"  unit="1" domain_ref="restart_Wtheta" />
       <field id="checkpoint_ice_fraction" name="ice_fraction" long_name="ice_fraction"  unit="1" domain_ref="restart_Wtheta" />
       <field id="checkpoint_liquid_fraction" name="liquid_fraction" long_name="liquid_fraction"  unit="1" domain_ref="restart_Wtheta" />
       <field id="checkpoint_bulk_fraction" name="bulk_fraction" long_name="bulk_fraction"  unit="1" domain_ref="restart_Wtheta" />
       <field id="checkpoint_rhcrit" name="rhcrit" long_name="rhcrit"  unit="1" domain_ref="restart_Wtheta" />
       <field id="checkpoint_tstar" name="tstar" long_name="tstar"  unit="K" domain_ref="restart_W3_2D" />
       <field id="checkpoint_zh" name="zh" long_name="zh"  unit="m" domain_ref="restart_W3_2D" />
       <field id="checkpoint_z0msea" name="z0msea" long_name="z0msea"  unit="m" domain_ref="restart_W3_2D" />
       <field id="checkpoint_ntml" name="ntml" long_name="ntml"  unit="1" domain_ref="restart_W3_2D" />
       <field id="checkpoint_cumulus" name="cumulus" long_name="cumulus"  unit="1" domain_ref="restart_W3_2D" />
     </field_group>

     <!-- Main diagnostic group -->
     <field_group id="diagnostic_fields" freq_op="1ts" operation="instant" enabled=".TRUE." >
       <field id="theta" name="theta" long_name="air_potential_temperature" standard_name="air_potential_temperature" unit="K" grid_ref="full_level_face_grid" />
       <field id="w_physics" name="w_physics" long_name="vertical_wind_on_physics_points" standard_name="vertical_velocity" unit="ms-1" grid_ref="full_level_face_grid" />
       <field id="dt_bl" name="dt_bl" long_name="BL temperature increment" unit="K" grid_ref="full_level_face_grid" />  
       <field id="dmv_bl" name="dmv_bl" long_name="BL vapour increment" unit="kg/kg" grid_ref="full_level_face_grid" />  
       <field id="dt_conv" name="dt_conv" long_name="Convection temperature increment" unit="K" grid_ref="full_level_face_grid" />  
       <field id="dmv_conv" name="dmv_conv" long_name="Convection vapour increment" unit="kg/kg" grid_ref="full_level_face_grid" />  
       <field id="m_v" name="m_v" long_name="m_v" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="m_cl" name="m_cl" long_name="m_cl" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="m_r" name="m_r" long_name="m_r" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="m_ci" name="m_ci" long_name="m_ci" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="m_s" name="m_s" long_name="m_s"  unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="m_g" name="m_g" long_name="m_g"  unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="area_fraction" name="area_fraction" long_name="area_fraction" unit="1" grid_ref="full_level_face_grid" />
       <field id="ice_fraction" name="ice_fraction" long_name="ice_fraction" unit="1" grid_ref="full_level_face_grid" />
       <field id="liquid_fraction" name="liquid_fraction" long_name="liquid_fraction" unit="1" grid_ref="full_level_face_grid" />
       <field id="bulk_fraction" name="bulk_fraction" long_name="bulk_fraction" unit="1" grid_ref="full_level_face_grid" />
       <field id="rhcrit" name="rhcrit" long_name="rhcrit" unit="1" grid_ref="full_level_face_grid" />
       <field id="rho" name="rho" long_name="air_density" standard_name="air_density" unit="kg m-3" grid_ref="half_level_face_grid" />
       <field id="xi1" name="xi1" long_name="Xi1" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="xi2" name="xi2" long_name="Xi2" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="xi3" name="xi3" long_name="Xi3" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="u1" name="u1" long_name="eastward_wind" standard_name="eastward_wind" unit="m s-1" grid_ref="half_level_edge_grid" />
       <field id="u2" name="u2" long_name="northward_wind" standard_name="northward_wind" unit="m s-1" grid_ref="half_level_edge_grid" />
       <field id="u3" name="u3" long_name="upward_air_velocity" standard_name="upward_air_velocity" unit="m s-1" grid_ref="full_level_face_grid" />
       <field id="divergence" name="divergence" long_name="divergence_of_wind" standard_name="divergence_of_wind" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="exner" name="exner" long_name="exner_pressure" unit="1" grid_ref="half_level_face_grid" />
     </field_group>

      <!-- Initial conditions group -->
     <field_group id="initial_fields" freq_op="1ts" operation="once" enabled=".TRUE." >
       <field id="init_theta" name="theta" long_name="air_potential_temperature" standard_name="air_potential_temperature" unit="K" grid_ref="full_level_face_grid" />
       <field id="init_m_v" name="m_v" long_name="m_v" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="init_m_cl" name="m_cl" long_name="m_cl" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="init_m_r" name="m_r" long_name="m_r" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="init_m_ci" name="m_ci" long_name="m_ci" unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="init_m_s" name="m_s" long_name="m_s"  unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="init_m_g" name="m_g" long_name="m_g"  unit="kg/kg" grid_ref="full_level_face_grid" />
       <field id="init_area_fraction" name="area_fraction" long_name="area_fraction"  unit="1" grid_ref="full_level_face_grid" />
       <field id="init_ice_fraction" name="ice_fraction" long_name="ice_fraction"  unit="1" grid_ref="full_level_face_grid" />
       <field id="init_liquid_fraction" name="liquid_fraction" long_name="liquid_fraction"  unit="1" grid_ref="full_level_face_grid" />
       <field id="init_bulk_fraction" name="bulk_fraction" long_name="bulk_fraction"  unit="1" grid_ref="full_level_face_grid" />
       <field id="init_rhcrit" name="rhcrit" long_name="rhcrit"  unit="1" grid_ref="full_level_face_grid" />
       <field id="init_rho" name="rho" long_name="air_density" standard_name="air_density" unit="kg m-3" grid_ref="half_level_face_grid" />
       <field id="init_xi1" name="xi1" long_name="Xi1" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="init_xi2" name="xi2" long_name="Xi2" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="init_xi3" name="xi3" long_name="Xi3" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="init_u1" name="u1" long_name="eastward_wind" standard_name="eastward_wind"  unit="m s-1" grid_ref="half_level_edge_grid" />
       <field id="init_u2" name="u2" long_name="northward_wind" standard_name="northward_wind" unit="m s-1" grid_ref="half_level_edge_grid" />
       <field id="init_u3" name="u3" long_name="upward_air_velocity" standard_name="upward_air_velocity" unit="m s-1" grid_ref="full_level_face_grid" />
       <field id="init_divergence" name="divergence" long_name="divergence_of_wind" standard_name="divergence_of_wind" unit="s-1" grid_ref="half_level_face_grid" />
       <field id="init_exner" name="exner" long_name="exner_pressure" unit="1" grid_ref="half_level_face_grid" />
     </field_group>
     
   </field_definition>

   <file_definition
      type="one_file"
      par_access="collective"
      time_counter="none">

      <!-- Checkpoint/ Restart group -->

      <!-- File definition for checkpoint write -->
      <file id="lfric_checkpoint" name="lfric_checkpoint" output_freq="1ts" convention="CF" enabled=".FALSE.">
        <field field_ref="checkpoint_theta"/>
        <field field_ref="checkpoint_exner"/>
        <field field_ref="checkpoint_rho"/>
        <field field_ref="checkpoint_u"/>
        <field field_ref="checkpoint_xi"/>
        <field field_ref="checkpoint_m_v"/>
        <field field_ref="checkpoint_m_cl"/>
        <field field_ref="checkpoint_m_r"/>
        <field field_ref="checkpoint_m_ci"/>
        <field field_ref="checkpoint_m_s"/>
        <field field_ref="checkpoint_m_g"/>
        <field field_ref="checkpoint_area_fraction"/>
        <field field_ref="checkpoint_ice_fraction"/>
        <field field_ref="checkpoint_liquid_fraction"/>
        <field field_ref="checkpoint_bulk_fraction"/>
        <field field_ref="checkpoint_rhcrit"/>
        <field field_ref="checkpoint_tstar"/>
        <field field_ref="checkpoint_zh"/>
        <field field_ref="checkpoint_z0msea"/>
        <field field_ref="checkpoint_ntml"/>
        <field field_ref="checkpoint_cumulus"/>
      </file> 
      
       <!-- file definition for restart read -->
      <file id="lfric_restart" name="lfric_checkpoint" mode="read" output_freq="1ts" cyclic="true" enabled=".FALSE.">
       <field id="restart_theta" name="theta" long_name="air_potential_temperature" standard_name="air_potential_temperature" unit="K" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_exner" name="exner" long_name="exner_pressure" unit="1" operation="instant" domain_ref="restart_W3" />
       <field id="restart_rho" name="rho" long_name="air_density" standard_name="air_density" unit="kg m-3" operation="instant" domain_ref="restart_W3" />
       <field id="restart_u" name="u" long_name="U" unit="m s-1" operation="instant" domain_ref="restart_W2" />
       <field id="restart_xi" name="xi" long_name="Xi" unit="s-1" operation="instant" domain_ref="restart_W1" />
       <field id="restart_m_v" name="m_v" long_name="m_v" unit="kg/kg" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_m_cl" name="m_cl" long_name="m_cl" unit="kg/kg" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_m_r" name="m_r" long_name="m_r" unit="kg/kg" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_m_ci" name="m_ci" long_name="m_ci" unit="kg/kg" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_m_s" name="m_s" long_name="m_s"  unit="kg/kg" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_m_g" name="m_g" long_name="m_g"  unit="kg/kg" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_area_fraction" name="area_fraction" long_name="area_fraction" unit="1" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_ice_fraction" name="ice_fraction" long_name="ice_fraction" unit="1" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_liquid_fraction" name="liquid_fraction" long_name="liquid_fraction" unit="1" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_bulk_fraction" name="bulk_fraction" long_name="bulk_fraction" unit="1" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_rhcrit" name="rhcrit" long_name="rhcrit" unit="1" operation="instant" domain_ref="restart_Wtheta" />
       <field id="restart_tstar" name="tstar" long_name="tstar" unit="K" operation="instant" domain_ref="restart_W3_2D" />
       <field id="restart_zh" name="zh" long_name="zh" unit="m" operation="instant" domain_ref="restart_W3_2D" />
       <field id="restart_z0msea" name="z0msea" long_name="z0msea" unit="m" operation="instant" domain_ref="restart_W3_2D" />
       <field id="restart_ntml" name="ntml" long_name="ntml" unit="1" operation="instant" domain_ref="restart_W3_2D" />
       <field id="restart_cumulus" name="cumulus" long_name="cumulus" unit="1" operation="instant" domain_ref="restart_W3_2D" />
      </file>


      <file id="lfric_diag" name="lfric_diag" output_freq="10ts" convention="UGRID" enabled=".TRUE.">
        <field field_ref="theta"/>
        <field field_ref="w_physics"/>
        <field field_ref="dt_bl"/>
        <field field_ref="dmv_bl"/>
        <field field_ref="dt_conv"/>
        <field field_ref="dmv_conv"/>
        <field field_ref="m_v"/>
        <field field_ref="m_cl"/>
        <field field_ref="m_r"/>
        <field field_ref="m_ci"/>
        <field field_ref="m_s"/>
        <field field_ref="m_g"/>
        <field field_ref="area_fraction"/>
        <field field_ref="ice_fraction"/>
        <field field_ref="liquid_fraction"/>
        <field field_ref="bulk_fraction"/>
        <field field_ref="rhcrit"/>
        <field field_ref="rho"/>
        <field field_ref="xi1"/>
        <field field_ref="xi2"/>
        <field field_ref="xi3"/>
        <field field_ref="u1"/>
        <field field_ref="u2"/>
        <field field_ref="u3"/>
        <field field_ref="divergence"/>
        <field field_ref="exner"/>
      </file>

      <file id="lfric_averages" name="lfric_averages" output_freq="10ts" convention="UGRID" enabled=".TRUE.">
        <field field_ref="theta" operation="average" />
        <field field_ref="w_physics" operation="average" />
        <field field_ref="u1" operation="average" />
        <field field_ref="u2" operation="average" />
        <field field_ref="u3" operation="average" />
        <field field_ref="divergence" operation="average" />
        <field field_ref="exner" operation="average" />
      </file>

      <file id="lfric_initial" name="lfric_initial" output_freq="1ts" convention="UGRID" enabled=".TRUE.">
        <field field_ref="init_theta"/>
        <field field_ref="init_m_v"/>
        <field field_ref="init_m_cl"/>
        <field field_ref="init_m_r"/>
        <field field_ref="init_m_ci"/>
        <field field_ref="init_m_s"/>
        <field field_ref="init_m_g"/>
        <field field_ref="init_area_fraction"/>
        <field field_ref="init_ice_fraction"/>
        <field field_ref="init_liquid_fraction"/>
        <field field_ref="init_bulk_fraction"/>
        <field field_ref="init_rhcrit"/>
        <field field_ref="init_rho"/>
        <field field_ref="init_xi1"/>
        <field field_ref="init_xi2"/>
        <field field_ref="init_xi3"/>
        <field field_ref="init_u1"/>
        <field field_ref="init_u2"/>
        <field field_ref="init_u3"/>
        <field field_ref="init_divergence"/>
        <field field_ref="init_exner"/>
      </file>

    </file_definition>

  </context>

  <context id = "xios">
    <variable_definition>
      <variable_group id = "buffer">
        <variable id = "optimal_buffer_size" type = "string" >performance</variable>
        <variable id = "buffer_factor_size" type = "double" >1.0</variable>
      </variable_group>

      <variable_group id = "parameters" >
        <variable id = "using_server" type = "bool" >true</variable>
        <variable id = "info_level" type = "int" >50</variable>
        <variable id = "print_file" type="bool">true</variable>
      </variable_group>
    </variable_definition>
  </context>

</simulation>
