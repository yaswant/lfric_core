!-----------------------------------------------------------------------------
! Copyright (c) 2017,  Met Office, on behalf of HMSO and Queen's Printer
! For further details please refer to the file LICENCE.original which you
! should have received as part of this distribution.
!-----------------------------------------------------------------------------

!>@brief Initialisation of a test field for the IO Mini App
module io_dev_init_fields_alg_mod

  use log_mod,                         only: log_event,         &
                                             log_scratch_space, &
                                             LOG_LEVEL_INFO,    &
                                             LOG_LEVEL_TRACE,   &
                                             LOG_LEVEL_ERROR

  use field_mod,                       only: field_type

  implicit none

  private
  public :: io_dev_init_fields_alg

contains
  !> @details An algorithm for initialising a test field
  !> @param[inout] test_field a test field
  subroutine io_dev_init_fields_alg(test_field)

    implicit none

    ! Prognostic fields
    type( field_type ),   intent(inout) :: test_field


    call log_event( "io_dev: Initialising test field", LOG_LEVEL_INFO )
    ! Set the field values to 1.0
    call invoke( setval_c( test_field, 1.0_r_def ) )

    call log_event( "io_dev: Initialised test field", LOG_LEVEL_INFO )

  end subroutine io_dev_init_fields_alg

end module io_dev_init_fields_alg_mod
