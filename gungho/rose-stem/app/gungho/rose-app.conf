meta=gungho/config-meta/lfric-gungho/HEAD

[command]
aprun   = aprun   -n 1 $BIN_DIR/gungho configuration.nml
mpiexec = mpiexec -n 1 $BIN_DIR/gungho configuration.nml
default = $BIN_DIR/gungho configuration.nml

[file:$DESTINATION_DIRECTORY]
mode=mkdir

[file:configuration.nml]
mode=auto
source=namelist:base_mesh
      = (namelist:damping_layer)
      =  namelist:extrusion
      =  namelist:finite_element
      =  namelist:formulation
      = (namelist:idealised)
      = (namelist:initial_density)
      = (namelist:initial_temperature)
      = (namelist:initial_wind)
      =  namelist:output
      =  namelist:planet 
      =  namelist:restart
      =  namelist:subgrid
      =  namelist:solver
      =  namelist:mixed_solver
      =  namelist:helmholtz_solver
      =  namelist:timestepping
      = (namelist:biperiodic_deppt)
      =  namelist:transport
      =  namelist:partitioning
      = (namelist:domain_size)
      =  namelist:mixing
      = (namelist:physics)
      =  namelist:orography
      = (namelist:orography_agnesi_cartesian)
      = (namelist:orography_agnesi_spherical)
      = (namelist:orography_bell_cartesian)
      = (namelist:orography_schar_cartesian)
      = (namelist:orography_schar_spherical)
      = (namelist:orography_dcmip200_spherical)
      = (namelist:multigrid)
      =  namelist:checks

[file:restart.nml]
source=namelist:restart_nml
mode=auto

[namelist:base_mesh]
prime_mesh_name     = 'dynamics'
fplane              = .false.
f_lat_deg           = 45.0

[namelist:damping_layer]
dl_base         = 800.0 
dl_str          = 0.5

[namelist:extrusion]
method           = 'uniform'
domain_top       = 10000.0
number_of_layers = 5

[namelist:finite_element]
cellshape         = 'quadrilateral'
element_order     = 0
coordinate_order  = 0
rehabilitate      = .true.
supg              = .false.
vorticity_in_w1   = .true.

[namelist:formulation]
rotating             = .true.
shallow              = .true.
transport_only       = .false.
use_moisture         = .false.
use_physics          = .false.
dry_static_adjust    = .false.
set_hydrostatic_init = .false.
init_exner_bt        = .true.
hard_wired_j         = .false.
hard_wired_detj      = .false.
dlayer_on            = .false.
use_wavedynamics     = .true.

[namelist:idealised]
test = 'gravity_wave'

[namelist:initial_density]
tracer_max = 2.0
tracer_background = 0.1
x1 = 0.0
y1 = 0.0
x2 = 0.0
y2 = 0.0

[namelist:initial_temperature]
bvf_square = 0.0001
theta_surf = 300.0

[namelist:initial_wind]
profile        = 'none'
u0             = 0.0
v0             = 0.0
sbr_angle_lat  = 0.0
sbr_angle_lon  = 0.0
smp_init_wind = .false.

[namelist:multigrid]
l_multigrid=.false.

[namelist:output]
diag_stem_name       = 'diagDynamo'
write_xios_output    = .false.
write_nodal_output   = .true.
diagnostic_frequency = 3
nodal_output_on_w3   = .true.
subroutine_timers    = .true.
write_minmax_tseries = .false.
subroutine_counters  = .false.

[namelist:physics]
boundary_layer_placement    = 0
convection_placement        = 0
heldsuarez_thermo_placement = 0
heldsuarez_wind_placement   = 0
hs_random = .false.
cloud_scheme = 'none' 
rhcritical = 0.99 
microphysics_placement = 0

[namelist:planet]
gravity        = 9.80665
radius         = 6371229.0
omega          = 7.292116E-5
rd             = 287.05
cp             = 1005.0
p_zero         = 100000.0
scaling_factor = 125.0

[namelist:restart]
filename = 'restart.nml'

[namelist:restart_nml]
checkpoint_read      = $RESTART_READ
checkpoint_write     = $RESTART_WRITE
restart_stem_name    = '$CYLC_SUITE_SHARE_DIR/data/restartDynamo_$ROSE_SUITE_NAME-$ROSE_TASK_NAME'
timestep_end         = $RESTART_STOP
timestep_start       = $RESTART_START
checkpoint_frequency = 9999
xios_checkpoint = .F

[namelist:solver]
method             = 'cg'
preconditioner     = 'diagonal'
maximum_iterations = 399
tolerance          = 1.0e-6
gcrk               = 18

[namelist:mixed_solver]
si_method             = 'gcr'
si_preconditioner     = 'pressure'
si_maximum_iterations = 10
gcrk                  = 18
si_tolerance          = 1.0e-6
guess_np1             = .F
reference_reset_freq  = 4
normalise             = .T

[namelist:helmholtz_solver]
gcrk                           = 18
method                         = 'bicgstab'
preconditioner                 = 'tridiagonal'
si_pressure_tolerance          = 1.0e-6
si_pressure_maximum_iterations = 400
normalise                      = .T

[namelist:subgrid]
rho_approximation                = 'ppm_no_limiter'
dep_pt_stencil_extent            = 3
rho_approximation_stencil_extent = 2

[namelist:biperiodic_deppt]
method              = 'euler'
n_dep_pt_iterations = 1

[namelist:transport]
scheme               = 'method_of_lines'
operators            = 'fv'
fv_flux_order        = 2
fv_advective_order   = 3
consistent_metric    = .false.
enforce_monotonicity = .false.

[namelist:partitioning]
auto = .true.

[namelist:domain_size]
planar_domain_min_x = -1.0
planar_domain_max_x =  1.0
planar_domain_min_y = -1.0
planar_domain_max_y =  1.0

[namelist:timestepping]
method                 = 'semi_implicit'
alpha                  = 0.5
tau_u                  = 0.5
tau_t                  = 0.5
tau_r                  = 0.5
outer_iterations       = 4
inner_iterations       = 1
runge_kutta_method     = 'ssp3'
spinup_period          = 1
spinup_alpha           = .false.
spinup_winds           = .false.
dt                     = $DT

[namelist:mixing]
viscosity    = .false.
viscosity_mu = 0.0
smagorinsky  = .false.
mix_factor   = 0.0

[namelist:orography]
profile   = 'none'

[namelist:orography_agnesi_cartesian]
mountain_height = 100.0
half_width_x    = 10.0
half_width_y    = 10.0
x_centre        = 0.0
y_centre        = 0.0
direction       = 'x'

[namelist:orography_agnesi_spherical]
mountain_height   = 100.0
half_width        = 2500.0
lambda_centre_dec = 1.5
phi_centre_dec    = 0.0
lambda_focus_dec  = 1.5
phi_focus_dec     = 0.3333

[namelist:orography_schar_cartesian]
mountain_height = 250.0
half_width_x    = 20.0
half_width_y    = 20.0
wavelength      = 20.0
x_centre        = 0.0
y_centre        = 0.0
direction       = 'x'

[namelist:orography_schar_spherical]
mountain_height   = 250.0
half_width        = 5000.0
wavelength        = 4000.0
lambda_centre_dec = 0.25
phi_centre_dec    = 0.0

[namelist:orography_dcmip200_spherical]
mountain_height     = 2000.0
radius_dec          = 0.75
osc_half_width_dec  = 0.0625
lambda_centre_dec   = 1.5
phi_centre_dec      = 0.0

[namelist:orography_bell_cartesian]
mountain_height = 400.0
half_width_x    = 1000.0
half_width_y    = 1000.0
x_centre        = 0.0
y_centre        = 0.0
direction       = 'xy'

[namelist:checks]
limit_cfl = .false.
max_cfl = 0.75
