#==============================================================================
# BOUNDARY LAYER:
#==============================================================================

[namelist:blayer]
compulsory=true
description=Boundary layer parametrization
ns=namelist/Science/UM Boundary layer
sort-key=Section-A04
title=Boundary layer

[namelist:blayer=a_ent_2]
compulsory=true
description=Empirical constant multiplying buoyancy reversal entrainment term
help=The entrainment parametrization includes a term dependent on the
    =strength of any negative buoyancy generated through evaporative cooling
    =on mixing between cloudy boundary layer air and cloud-free air entrained
    =from above the boundary layer.  LES studies suggest a value 0.056.
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A08a
type=real

[namelist:blayer=a_ent_shr]
compulsory=true
description=Empirical constant multiplying ustar entrainment term
help=The entrainment parametrization includes a term dependent on the
    =friction velocity (ustar). The constant of proportionality had
    =been 5.0 but the LES of Beare (2008) together with UKV case
    =studies suggest a lower value would be more appropriate
    =(Beare gives 1.6).
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:10.0
sort-key=Panel-A08
type=real

[namelist:blayer=bl_levels]
description=Number of boundary layer levels
help=Typically only the levels in the lowest few kilometres of the
    =atmosphere are passed to the boundary layer scheme,
    =in order to save on
    =CPU time.  Depending on the choices in the Boundary Layer panel,
    =the
    =local scheme can be applicable to mixing processes in the free atmosphere
    =above the boundary layer.
!kind=default
ns=namelist/Science/UM Boundary layer
range=1:
sort-key=Panel-A01
type=integer

[namelist:blayer=bl_mix_w]
compulsory=true
description=Allow BL scheme to mix vertical velocity
help=Typically this is used in convective scale applications when horizontal
    =mixing via the Smagorinsky scheme is also included.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A13
type=logical

[namelist:blayer=cbl_mix_fac]
compulsory=true
description=Parameter to control convective BL stability function
help=Parameter to control mixing from the Ri-based scheme in convective
    =boundary layers, varying from 'Conventional' (0.0) to 'Standard' (1.0)
    =LEM functions
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A02a
type=real

[namelist:blayer=cbl_opt]
compulsory=true
description=Convective BL stability function
!enumeration=true
help=Three options are available for the stability functions for unstable
    =(negative) Richardson numbers: those described as the "standard" and
    ="conventional" subgrid models in the LES of Brown (1999), and an option
    =to adjust between the previous two using a parameter 'cbl_mix_fac'.
    =The conventional model gives significantly less mixing than the standard.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A02
trigger=namelist:blayer=cbl_mix_fac: 'adjustable';
value-titles=Conventional LEM,Standard LEM,Adjustable LEM
values='conventional','standard','adjustable'

[namelist:blayer=dec_thres_cloud]
compulsory=true
description=Decoupling threshold for cloudy boundary layers
help=This is recommended to be set to 0.1
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A11a
type=real

[namelist:blayer=dyn_diag]
compulsory=true
description=Shear driven BL diagnosis options
!enumeration=true
help=In situations where surface conditions are close to neutral and the
    =land fraction is less than a half,
    =the thermodynamic parcel ascent diagnosis of both cumulus and
    =non-local boundary layers are over-ruled to leave turbulent mixing
    =to be determined by the local Richardson number scheme only.
    ="zi/L used over sea" gives problems when BL_LEVELS is high,
    =therefore "zi/L revised over sea" corrects this.
    ="zi/L used in Cumulus over sea" applies this only to points
    =diagnosed with Cumulus and strictly for sea points (fland<0.01,
    =cf 0.5).
    ="Ri based" also overrides Cumulus diagnosis if
    =Zh(Ri) > Zlcl+zhloc_depth_fac*(Zhpar-Zlcl).
    =Note that here Ri accounts for gradient adjustment by the
    =non-local scheme. This option further restricts a Cumulus diagnosis
    =to allow for disruption of cumulus formation through vertical wind
    =shear (diagnosed through a sub-critical Richardson number profile
    =extending well into the cloud layer). Under these circumstances the
    =non-local boundary layer scheme is allowed to mix up to the original
    =parcel ascent top.
    =
    =Additionally,
    =for all options (other than 0) the consistency of the provisional
    =diagnosis of an unstable boundary layer in CONV_DIAG is checked
    =against the surface flux diagnosed by the surface exchange routines.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A09
trigger=namelist:blayer=zhloc_depth_fac: 'ri_based';
value-titles=zi/L revised over sea,zi/L used in Cumulus over sea,Ri based
values='zi_l_sea','zi_l_cu','ri_based'

[namelist:blayer=fixed_flux_e]
compulsory=true
description=Surface latent heat flux [Wm-2]
help=Fixed value used throughout the run.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A01a
type=real

[namelist:blayer=fixed_flux_h]
compulsory=true
description=Surface sensible heat flux [Wm-2]
help=Fixed value used throughout the run
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A01b
type=real

[namelist:blayer=flux_bc_opt]
compulsory=true
description=Surface flux production
!enumeration=true
help=This switch allows the user to specify the surface fluxes and/or surface
    =stresses as follows:
    =
    =  'interactive' Interactive fluxes calculated by Jules
    =  'specified_scalars' Specified scalar fluxes (sensible and latent heat)
    =    that are then calculated explicitly (this option is not recommended
    =    with interactive radiation because Tstar for upward LW is estimated)
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A01
trigger=namelist:blayer=fixed_flux_e: 'specified_scalars';
       =namelist:blayer=fixed_flux_h: 'specified_scalars';
value-titles=Interactive fluxes,Specified scalar fluxes only
values='interactive','specified_scalars'

[namelist:blayer=free_atm_mix]
compulsory=true
description=Free atmospheric turbulent mixing option
!enumeration=true
help=Relax to SHARPEST: the stable stability function requested relaxes
    =towards the "SHARPEST" function with height above the surface,
    =with a fixed height scale of 1km. If "Do not reduce mixing lengths
    =above the BL top" is selected this option will also smoothly merge
    =to the asymptotic mixing length by 3km above the surface.
    =
    =Corrected NTML is as the original but corrects the level
    =(ntml_local) below which the boundary layer value is used.
    =The final option extends this version to use interactively diagnosed
    =turbulent layer depths throughout the atmospheric column.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A05
value-titles=Relax to SHARPEST,Original with corrected NTML,
            =Original with diagnosed turbulent layer depths
values='to_sharp','ntml_corrected','free_trop_layer'

[namelist:blayer=fric_heating]
compulsory=true
description=Apply heating source from turbulence dissipation
help=The drag on the resolved scale flow exerted by the boundary layer
    =turbulence parametrization should ultimately be dissipated as heat
    =but unless this option is selected this heating is ignored. It is
    =recommended to be implemented in all model versions.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A04
type=logical

[namelist:blayer=interp_local]
compulsory=true
description=Choice of interpolation method for buoyancy gradient in Ri
!enumeration=true
help=Due to the winds and scalar fields being on staggered vertical grids,
    =vertical interpolation is required to calculate the local turbulent
    =diffusivity (as a function of shear and static stability).
    =There are multiple options for the order of calculation / which
    =fields to interpolate:
    =  1) Interpolate the vertical gradients of sl,qw from their native
    =     rho-levels to theta-levels, and calculate stability, dbdz, and Kh
    =     on theta-levels.
    =     This has the advantage that the stability calculation can
    =     use the cloud-fraction on its native grid.  But a disadvantage
    =     is that, since the gradients have to be interpolated,
    =     sharp changes in qw in cloud-free air above cloud-top inversions
    =     get multiplied by the in-cloud buoyancy coefficients.
    =     This can lead to arguably spurious instability at cloud-top
    =     and hence large fluxes through cloud-capping inversions.
    = 2)  Calculate stability, dbdz, on rho-levels where the gradients of
    =     sl,qw are defined (using an interpolated cloud-fraction),
    =     and then interpolate dbdz onto theta-levels to calculate Kh.
    =     This avoids the problem with option (1) at cloud-top inversions,
    =     but introduces additional complexity regarding how to
    =     interpolate the cloud-fraction onto rho-levels.  The method used
    =     is to estimate the volume fraction of the rho-level that is
    =     saturated, based on the cloud-fractions at the neighbouring
    =     theta-levels, combined with the gradient of total-water
    =     supersaturation qw - qsat(Tl) between the two levels.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A04
value-titles=Interpolate sl and qw gradients to compute dbdz on theta-levels,
            =Compute dbdz on rho-levels and then interpolate to theta-levels
values='gradients','cf_dbdz'

[namelist:blayer=near_neut_z_on_l]
compulsory=true
description=Threshold value of z/l below which to diagnose shear-driven BL
help=This is recommended to be set to 1.6
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:10.0
sort-key=Panel-A09a
type=real

[namelist:blayer=new_kcloudtop]
compulsory=true
description=Use less level-dependent radiative flux jump calculation
help=This logical implements a new method to identify the cloud top in the
    =radiative flux profile that results in a radiative flux jump estimation
    = that has been found to be less resolution sensitive.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A10
type=logical

[namelist:blayer=noice_in_turb]
compulsory=true
description=Ignore cloud ice in the BL turbulence scheme
help=If enabled the BL scheme will ignore all cloud ice
    =(water content, qcf, and fraction, cff) in its conserved variables
    =and mixing calculations.  Specifically this includes:
    =1) the calculation of buoyancy
    =2) the calculation of saturated humidity
    =3) the definition of conserved variables
    =   (ie sL=T+gz/cp - Lv qcl and qT=qv+qcl)
    =To do so would effectively assume the timescales for ice freezing/melting
    =are slower than the turbulence timescales, which is true for larger
    =particles but perhaps less so for small crystals.
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A14
type=logical

[namelist:blayer=p_unstable]
compulsory=true
description=Parameter for implicit solver in unstable BL column
help=Using 1.0 is recommended. In general,
    =the higher these values are,
    =the more stable the scheme becomes. However,
    =running with great nonlinear stability at an
    =area which is not required (where a weakly
    =nonlinear is problem is solved) results in lower accuracy.
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:100.0
sort-key=Panel-A12
type=real

[namelist:blayer=reduce_fa_mix]
compulsory=true
description=Options for where to reduce the local diffusion coefficients
!enumeration=true
help=Switch to decide where to keep the diffusion coefficient calculated
    =by the local Richardson number scheme. It is found beneficial to avoid
    =spurious mixing across well-defined inversions,
    =particularly for stratocumulus-capped boundary layers,
    =by setting these to zero.
    =It can also be appropriate to remove this local mixing across the
    =lifting condensation level in cumulus-capped layers.
    =If the boundary layer mixing is blending with the Smagorinsky subgrid
    =turbulence scheme then the local coefficients are only reduced by
    =applying the 1D weighting function,
    =rather than set to zero.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A06
value-titles=Reduce in the levels spanning inversions and the LCL in cumulus,
            =Reduce in the levels spanning inversions
values='inv_and_cu_lcl','inv_only'

[namelist:blayer=relax_sc_over_cu]
compulsory=true
description=Allow stratocumulus to be diagnosed over deep convection
!kind=default
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A11
type=logical

[namelist:blayer=sbl_opt]
compulsory=true
description=Stable BL stability function
!enumeration=true
help=The first nine options are variations on the Richardson number scheme
    =and reflect the range of tunings used in operational models. The
    =functions listed in increasing order of mixing strength are: SHARPEST,
    =Louis,
    =Long tails.
    =
    =Selecting the LEM stability functions enables the user to use a
    =stability dependence more relevant to Large-eddy simulation and can
    =be used if direct comparison with the Met Office LEM is desired.
    =
    =The Equilibrium stable boundary layer scheme is a complex research
    =formulation based on the second-moment equations with boundary layer
    =depth as a controlling parameter. The Boundary layer depth based
    =formulation option is a simpler scheme than the Equilibrium one
    =based on boundary layer depth derived from the turbulent kinetic
    =energy budget.
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A03
value-titles=SHARPEST,SHARP-sea; Mes-land
values='sharpest','sharp_sea_mes_land'

[namelist:blayer=sg_orog_mixing]
compulsory=true
description=Option for treating unresolved drainage flows
!enumeration=true
help=Drainage flows often form in hilly areas as the air near the surface
    =cools at night.  Where these flows are on scales too small to be
    =resolved their effects on vertical mixing (through induced wind shear)
    =should be included. Two independent methods to do this have been coded.
    =Currently these require the orographic stress (LAND_SURF panel) and GWD
    =schemes to be switched on in order to have the necessary ancillary
    =fields loaded. The subgrid shear options currently convert these into
    =a mean slope using an empirical relationship derived for the UKV only,
    =and so this is not recommended for any other model. These options
    =include the shear in the calculation of the Richardson number and
    =diffusion coefficients,
    =with an additional option to enhance the mixing lengths. The other
    =option is to relate the length of the SHARPEST tail to subgrid orography,
    =following McCabe and Brown (2007).
ns=namelist/Science/UM Boundary layer
sort-key=Panel-A07
value-titles=None,Subgrid shear plus enhanced mixing lengths
values='none','shear_plus_lambda'

[namelist:blayer=zhloc_depth_fac]
compulsory=true
description=Fractional cloud height reached by local BL depth calculation
!kind=default
ns=namelist/Science/UM Boundary layer
range=0.0:1.0
sort-key=Panel-A09a
type=real
